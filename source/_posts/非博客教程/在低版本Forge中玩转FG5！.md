---
title: 在低版本Forge中玩转FG5！
top_img: false
cover: 'https://image.kmar.top/bg/b17.jpg!/fw/550'
categories:
  - Java
tags:
  - 教程
  - MC
  - 环境
description: 之前为了在模组开发中使用Kotlin，想办法在Forge-1.12.2中使用了FG5，当时着实是废了不少功夫，所以写个教程记录一下。
abbrlink: 6d850038
date: 2022-05-11 14:44:29
updated: 2022-05-15 13:29:19
---

## 思路

&emsp;&emsp;想要尝试在低版本的Forge上使用`FG5+`是因为`Kotlin`的`gradle`插件要求的`gradle`版本只有`FG5+`支持。

&emsp;&emsp;首先说一下为什么我确信可以在低版本上使用`FG5+`，因为在使用`FG2.3`的时候构建完毕有一条输出，原文我没有记住，翻译过来就是：“使用FG5+来体验新的生产工具”。

&emsp;&emsp;但是我个人并不会编写`gradle`，自行编写肯定是不现实的。于是我就想到了一个最简单的办法：把高版本的`build.gradle`搬过来不就好了？

&emsp;&emsp;但是说起来简单做起来难，中间我遇到了各种各样的问题。具体内容我就不再多说，直接给出最终解决方案。

## 教程

{% p blue center, 如果没有特别声明，本文均以项目根目录为基础 %}

### 升级 Gradle

&emsp;&emsp;首先我们肯定要升级`Gradle`版本，升级方法很简单，修改：

{% p center, gradle/wrapper/gradle-wrapper.properties %}

```diff
  distributionBase=GRADLE_USER_HOME
  distributionPath=wrapper/dists
- distributionUrl=https\://services.gradle.org/distributions/gradle-?.?-bin.zip
+ distributionUrl=https\://services.gradle.org/distributions/gradle-7.4-bin.zip
  zipStoreBase=GRADLE_USER_HOME
  zipStorePath=wrapper/dists
```

&emsp;&emsp;其中，`gradle-7.4-bin.zip`中间的数字就是我们需要的版本号，读者也可以根据自己的需要选择不同版本，但是注意，`FG5+`有最低版本要求。

### 编写 build.gradle

&emsp;&emsp;为了以防万一，读者最好先备份一下自己已有的`build.gradle`，然后将以下内容CV进去：

```groovy
buildscript {
    ext.kotlin_version = '1.6.10'   //kotlin
    repositories {
        mavenLocal()
        // These repositories are only for Gradle plugins, put any other repositories in the repository block further below
        maven { url = 'https://repo.spongepowered.org/repository/maven-public/' }
        maven { url = 'https://maven.minecraftforge.net' }
        mavenCentral()
    }
    dependencies {
        classpath group: 'net.minecraftforge.gradle', name: 'ForgeGradle', version: '5.1.+', changing: true
        classpath 'org.spongepowered:mixingradle:0.7.+'                         //mixin
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"   //kotlin
    }
}
// Only edit below this line, the above code adds and enables the necessary things for Forge to be setup.
apply plugin: 'net.minecraftforge.gradle'   //forge
apply plugin: 'kotlin'                      //kotlin
apply plugin: 'org.spongepowered.mixin'     //mixin

version = '1.0'
group = '[]' // http://maven.apache.org/guides/mini/guide-naming-conventions.html
archivesBaseName = '[]'

minecraft {
    mappings channel: 'snapshot', version: '20171003-1.12'
    runs {
        client {
            workingDirectory project.file('run')

            // Recommended logging data for a userdev environment
            // The markers can be added/remove as needed separated by commas.
            // "SCAN": For mods scan.
            // "REGISTRIES": For firing of registry events.
            // "REGISTRYDUMP": For getting the contents of all registries.
            property 'forge.logging.markers', 'REGISTRIES'

            // Recommended logging level for the console
            // You can set various levels here.
            // Please read: https://stackoverflow.com/questions/2031163/when-to-use-the-different-log-levels
            property 'forge.logging.console.level', 'debug'

            // Comma-separated list of namespaces to load gametests from. Empty = all namespaces.
            property 'forge.enabledGameTestNamespaces', 'mi'
        }

        server {
            workingDirectory project.file('run')

            property 'forge.logging.markers', 'REGISTRIES'

            property 'forge.logging.console.level', 'debug'

            // Comma-separated list of namespaces to load gametests from. Empty = all namespaces.
            property 'forge.enabledGameTestNamespaces', 'mi'
        }
    }
}

// Include resources generated by data generators.

repositories {
    mavenCentral()
    // Put repositories for dependencies here
    // ForgeGradle automatically adds the Forge maven and Maven Central for you

    // If you have mod jar dependencies in ./libs, you can declare them as a repository like so:
    // flatDir {
    //     dir 'libs'
    // }
}

dependencies {
    //forge
    minecraft 'net.minecraftforge:forge:1.12.2-14.23.5.2859'
    //mixin
    implementation 'org.spongepowered:mixin:0.8.5'
    annotationProcessor 'org.spongepowered:mixin:0.8.5:processor'
    //kotlin
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
}

mixin {
    // MixinGradle Settings
    add sourceSets.main, '[]'
    config '[]'
}

// Example for how to get properties into the manifest for reading at runtime.
jar {
    manifest.attributes([
            "Specification-Title"        : "examplemod",
            "Specification-Vendor"       : "examplemodsareus",
            "Specification-Version"      : "1", // We are version 1 of ourselves
            "Implementation-Title"       : project.name,
            "Implementation-Version"     : project.jar.archiveVersion,
            "Implementation-Vendor"      : "examplemodsareus",
            "Implementation-Timestamp"   : new Date().format("yyyy-MM-dd'T'HH:mm:ssZ"),
            //mixin
            "TweakClass"                 : "[TweakClass]",
            "FMLCorePluginContainsFMLMod": true
    ])
}

//UTF-8
tasks.withType(JavaCompile) {
    options.encoding = "UTF-8"
}

//这两条是kotlin内容
compileKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
    }
}
compileTestKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
    }
}
```

&emsp;&emsp;请注意，以上的`build.gradle`是针对`forge:1.12.2-14.23.5.2859`编写的，如果你要使用其它`forge`版本请自行修改相应参数。

&emsp;&emsp;同时这份`build.gradle`中包含了`mixin`与`kotlin`，如果有不需要的组件还请自行删除，同时请注意`mixin`的参数需要自己补充。

### 修复资源错误

&emsp;&emsp;完成`gradle`的构建之后，启动游戏就会发现自己模组的所有资源都无法加载，标准解决方案是修改`build.gradle`，我们这里使用`Windows`的软连接来解决问题。

&emsp;&emsp;打开命令提示符进入项目根目录，执行下面的命令：

{% p center, <code>mklink /J &quot;out/production/classes/assets&quot; &quot;out/production/resources/assets&quot;</code> %}

&emsp;&emsp;这上面的路径各位根据自己的情况进行调整。

## 资源

&emsp;&emsp;对于`forge:1.12.2-14.23.5.2859`我在网上上传了离线包供各位下载，由于阿里云盘不能分享压缩包，有需要的小伙伴可以加Q群（1071299300）在群文件中下载。

## 鸣谢

+ MCreator讨论群（239746610）内的大佬们
+ [执着](https://github.com/luiqn2007)
+ ZK